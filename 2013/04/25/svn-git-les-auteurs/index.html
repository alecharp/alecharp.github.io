<html>
<head>
  <meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>alecharp.fr: SVN-Git -- les auteurs</title>

  <link href="https://fonts.googleapis.com/css?family=Fira+Sans+Extra+Condensed:200,600" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" media="screen" href="/css/index.css" />
  <link rel="stylesheet" media="screen" href="/css/syntax.css" />
  <link rel="stylesheet" media="screen" href="/css/font-awesome.min.css" />
</head>

<body>
  <div id="container">

<navbar>
  <div class="spacer"></div>
  <div><a href="/" title="alecharp.fr">alecharp.fr</a></div>
  <nav>
    <ul>
      <li>
        <a href="//twitter.com/alecharp" title="alecharp's Twitter"><i class="fa fa-twitter"></i></a>
      </li>
      <li>
        <a href="//github.com/alecharp" title="alecharp's Github"><i class="fa fa-github"></i></a>
      </li>
      <li>
        <a href="/index.xml" title="alecharp.fr's RSS"><i class="fa fa-rss"></i></a>
      </li>
      <li>
        <a href="//speakerdeck.com/alecharp" title="alecharp's SpeakerDeck"><i class="fa fa-slideshare"></i></a>
      </li>
    </ul>
  </nav>
</navbar>


<main>
  

<article>
  <header>
    <h1>SVN-Git -- les auteurs</h1>
    <time pubdate="2013-04-25">
      <i class="fa fa-calendar"></i> 2013-04-25
    </time>
  </header>
  <section>
    

<p>Juste pour mon souvenir : Git c&rsquo;est mieux que Subversion. Rapide, discret, efficace. Bref je ne veux plus faire de Subversion.</p>

<p>Malheureusement, la vie c&rsquo;est dur et du Subversion il y en a partout. Si si je vous jure ! La solution ? <strong>git-svn</strong>.</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">git</span> <span class="n">svn</span> <span class="n">clone</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">svn-repo-url</span></code></pre></td></tr></table>
</div>
</div>

<p>Pas aussi simple : il vous faut les auteurs (au moins).</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">svn</span> <span class="n">log</span> <span class="p">-</span><span class="n">-quiet</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">svn-repo-url</span> <span class="p">|</span> <span class="n">awk</span> <span class="s1">&#39;/^r/ {print $3}&#39;</span> <span class="p">|</span> <span class="n">sort</span> <span class="n">-u</span></code></pre></td></tr></table>
</div>
</div>

<p>* merci à <a href="http://stackoverflow.com/a/2495010">stackoverflow et Mike DeSimone</a></p>

<p>Vous prenez la sortie, vous la mettez dans un fichier, disons <code>svn-authors.list</code>. Vous devez ensuite l&rsquo;éditer pour le mettre sous la forme suivante :</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">svn-login</span> <span class="p">=</span> <span class="n">Firstname</span> <span class="n">Name</span> <span class="p">&lt;</span><span class="n">email</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>

<p>puis vous faites votre <code>git-svn</code></p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">git</span> <span class="n">svn</span> <span class="n">clone</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">svn-repo-url</span> <span class="p">-</span><span class="n">-authors</span><span class="o">-file</span><span class="p">=</span><span class="n">svn-authors</span><span class="p">.</span><span class="n">list</span></code></pre></td></tr></table>
</div>
</div>

<p>Si vous souhaitez prendre les tags et autres branches ?</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">git</span> <span class="n">svn</span> <span class="n">clone</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">svn-repo-url</span> <span class="p">-</span><span class="n">-authors</span><span class="o">-file</span><span class="p">=</span><span class="n">svn-authors</span><span class="p">.</span><span class="n">list</span> <span class="p">-</span><span class="n">-stdlayout</span></code></pre></td></tr></table>
</div>
</div>

<p>ou</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">git</span> <span class="n">svn</span> <span class="n">clone</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">svn-repo-url</span> <span class="p">-</span><span class="n">-authors</span><span class="o">-file</span><span class="p">=</span><span class="n">svn-authors</span><span class="p">.</span><span class="n">list</span> <span class="n">-T</span> <span class="n">trunk</span> <span class="n">-b</span> <span class="n">branches</span> <span class="n">-t</span> <span class="n">tags</span></code></pre></td></tr></table>
</div>
</div>

<p>bon par contre, les tags Subversion sont vus comme des branches sur Git. Pour infos, c&rsquo;est pas super grave mais ça se corrige <strong>très</strong> facilement.</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="p">`</span><span class="n">git</span> <span class="n">branch</span> <span class="n">-r</span> <span class="p">|</span> <span class="n">grep</span> <span class="s2">&#34;svn/tags&#34;</span><span class="p">`;</span> <span class="k">do</span>
	<span class="n">tagname</span><span class="p">=`</span><span class="n">echo</span> <span class="nv">$i</span> <span class="p">|</span> <span class="n">perl</span> <span class="n">-p</span> <span class="n">-e</span> <span class="s1">&#39;s/svn\\/tags\\///sig;&#39;</span><span class="p">`;</span>
	<span class="n">git</span> <span class="n">tag</span> <span class="n">-a</span> <span class="n">-m</span> <span class="s2">&#34;`git log --pretty=format:%s $i^\!</span><span class="se">`&#34;</span><span class="s2"> $tagname $i^ 1&gt; /dev/null;
</span><span class="s2">	git branch -r -d $i 1&gt; /dev/null;
</span><span class="s2">done</span></code></pre></td></tr></table>
</div>
</div>

<h2 id="astuce">Astuce</h2>

<p>Le fichier des auteurs Subversion sera connu dans la configuration de Git via sont chemin absolu. Celui-ci se trouve pour le moment à l&rsquo;extérieur du repository Git. Histoire de le garder avec, déplacez-le dans le dossier <code>.git</code> du repository et modifiez la configuration du repository :</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="n">cp</span> <span class="n">svn-authors</span><span class="p">.</span><span class="n">list</span> <span class="p">&lt;</span><span class="n">repo</span><span class="p">&gt;/.</span><span class="n">git</span><span class="p">/</span>
<span class="n">vim</span> <span class="p">&lt;</span><span class="n">repo</span><span class="p">&gt;/.</span><span class="n">git</span><span class="p">/</span><span class="n">config</span></code></pre></td></tr></table>
</div>
</div>

<p>configuration:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">[svn]
  authors file = .git/svn-authors.list</code></pre></td></tr></table>
</div>
</div></p>

<h2 id="nota-bene">Nota bene</h2>

<p>Si vous allez faire vos premiers commits Subversion sur le repository en passant par Git, il vous faut rajouter une ligne dans le fichier <code>svn-authors.list</code> avec votre identifiant Subversion et Git que vous devez utiliser.</p>

<h2 id="références">Références</h2>

<ul>
<li><a href="http://stackoverflow.com/a/2495010">stackoverflow et Mike DeSimone</a></li>
<li><a href="http://blog.bazoud.com/articles/2012-07-11-conversion-en-masse-de-projets-svn-vers-git/index.html">Olivier Bazoud &ndash; Conversion en masse de projets SVN vers Git</a></li>
</ul>

  </section>
</article>


</main>

  <footer>
    &copy; 2012 - 2019
  </footer>

  </div>
</body>
</html>

